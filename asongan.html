<!DOCTYPE html>
<html lang="id">
<head>
  <!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daftar Harga Asongan & ATK</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>Daftar Harga Barang Asongan & ATK</h1>
  <a href="index.html" class="btn-back">â¬… Kembali ke Menu Utama</a>

  <form id="formBarang">
    <input type="text" id="namaBarang" placeholder="Nama Barang" required>
    <input type="text" id="merek" placeholder="Merek (opsional)">
    <input type="number" id="hargaBeli" placeholder="Harga Beli (Rp)" required>
    <input type="number" id="jumlahIsi" placeholder="Jumlah Isi" required>
    <input type="number" id="hargaJual" placeholder="Harga Jual (Rp)">
    <button type="submit" class="action">Tambah Barang</button>
  </form>

  <table id="tabelBarang">
    <tr>
      <th>No</th>
      <th>Nama Barang</th>
      <th>Merek</th>
      <th>Harga Beli (Rp)</th>
      <th>Jumlah Isi</th>
      <th>Modal / pcs (Rp)</th>
      <th>Harga Jual (Rp)</th>
      <th>Keuntungan / pcs (Rp)</th>
      <th>Aksi</th>
    </tr>
  </table>

  <script>
  // ðŸ”¹ GANTI BAGIAN INI DENGAN firebaseConfig KAMU ðŸ”¹
  
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDGpOORQ9Sml8xIiGcWih7GiZ-tL8W3uNQ",
    authDomain: "hudasa-shop.firebaseapp.com",
    projectId: "hudasa-shop",
    storageBucket: "hudasa-shop.firebasestorage.app",
    messagingSenderId: "715669081861",
    appId: "1:715669081861:web:5d947077b9991b392bb16c",
    measurementId: "G-MNF31EMG9Y"
  };
  

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let editId = null;

  document.getElementById('formBarang').addEventListener('submit', function(e) {
    e.preventDefault();

    const nama = document.getElementById('namaBarang').value.trim();
    const merek = document.getElementById('merek').value.trim() || "-";
    const hargaBeli = parseFloat(document.getElementById('hargaBeli').value);
    const jumlah = parseFloat(document.getElementById('jumlahIsi').value);
    const hargaJual = parseFloat(document.getElementById('hargaJual').value) || 0;

    const modal = hargaBeli / jumlah;
    const untung = hargaJual ? (hargaJual - modal) : 0;

    const data = { nama, merek, hargaBeli, jumlah, modal, hargaJual, untung };

    if (editId) {
      db.ref('barang/' + editId).set(data);
      editId = null;
    } else {
      db.ref('barang').push(data);
    }

    this.reset();
  });

  function renderTable(snapshot) {
    const table = document.getElementById('tabelBarang');
    table.innerHTML = `
      <tr>
        <th>No</th>
        <th>Nama Barang</th>
        <th>Merek</th>
        <th>Harga Beli (Rp)</th>
        <th>Jumlah Isi</th>
        <th>Modal / pcs (Rp)</th>
        <th>Harga Jual (Rp)</th>
        <th>Keuntungan / pcs (Rp)</th>
        <th>Aksi</th>
      </tr>
    `;

    const data = snapshot.val();
    if (!data) return;

    let index = 1;
    const sortedKeys = Object.keys(data).sort((a, b) =>
      data[a].nama.localeCompare(data[b].nama, 'id', { sensitivity: 'base' })
    );

    sortedKeys.forEach((id) => {
      const b = data[id];
      const row = table.insertRow();
      row.innerHTML = `
        <td>${index++}</td>
        <td style="background-color: #c7c6c1; font-size:20px;">${b.nama}</td>
        <td style="background-color: #d6cfc7; font-size:20px;">${b.merek || "-"}</td>
        <td>${b.hargaBeli.toLocaleString()}</td>
        <td>${b.jumlah}</td>
        <td>${b.modal.toFixed(0).toLocaleString()}</td>
        <td style="background-color: #bebd88; font-size:35px;"><b>${b.hargaJual ? b.hargaJual.toLocaleString() : "-"}</b></td>
        <td>${b.hargaJual ? b.untung.toFixed(0).toLocaleString() : "-"}</td>
        <td>
          <button class="action" onclick="editBarang('${id}')">Edit</button>
          <button class="delete" onclick="hapusBarang('${id}')">Hapus</button>
        </td>
      `;
    });
  }

  db.ref('barang').on('value', renderTable);

  function editBarang(id) {
    db.ref('barang/' + id).once('value').then((snapshot) => {
      const b = snapshot.val();
      document.getElementById('namaBarang').value = b.nama;
      document.getElementById('merek').value = b.merek !== "-" ? b.merek : "";
      document.getElementById('hargaBeli').value = b.hargaBeli;
      document.getElementById('jumlahIsi').value = b.jumlah;
      document.getElementById('hargaJual').value = b.hargaJual || "";
      editId = id;
    });
  }

  function hapusBarang(id) {
    if (confirm('Yakin ingin menghapus barang ini?')) {
      db.ref('barang/' + id).remove();
   Â }
Â Â }
</script>

</body>

</html>
